*** Settings ***
Library           SSHLibrary

*** Variables ***
${HOST}           your.linux.server
${USER}           your_username
${PASSWORD}       your_password
${SUDO_USER}      QAuser
${BEELINE_CMD}    beeline -u "jdbc:hive2://your.hive.server:10000/default" -n ${USER} -p ${PASSWORD} --silent=true --outputformat=csv2 -e "YOUR_HIVE_QUERY_HERE" > output.csv

*** Test Cases ***
Login And Execute Hive Queries
    [Documentation]    Logs into a Linux server, runs a sudo command, executes HIVE queries, and fetches data in CSV format.
    Connect To Linux
    Switch To Sudo User
    Execute Beeline Queries
    Fetch Data In CSV
    Disconnect From Linux

*** Keywords ***
Connect To Linux
    [Documentation]    Connect to the Linux server using SSH.
    Open Connection    ${HOST}
    Login              ${USER}    ${PASSWORD}

Switch To Sudo User
    [Documentation]    Switch to the sudo user without a password.
    Write              sudo -u ${SUDO_USER} -i
    ${output}          Read Until Prompt    $
    Log                ${output}

Execute Beeline Queries
    [Documentation]    Execute HIVE queries using Beeline on the Linux server.
    Write              ${BEELINE_CMD}
    ${output}          Read Until Prompt    $
    Log                ${output}

Fetch Data In CSV
    [Documentation]    Fetch the data from the output CSV file.
    Get File           output.csv    local_output.csv

Disconnect From Linux
    [Documentation]    Disconnect from the Linux server.
    Close Connection
