import openpyxl
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
from openpyxl import Workbook

# Step 1: Open xlsm file
file_path = "your_file.xlsm"
workbook = load_workbook(filename=file_path, read_only=False, keep_vba=True)

# Step 2: On Main worksheet, click on Reconnect DB Button
main_sheet = workbook["Main"]
reconnect_button = main_sheet['Reconnect DB Button']

# Step 3: Go to line 16, column E, select ACBS from dropdown
line_number = 16
column_letter = 'E'
cell_address = f"{column_letter}{line_number}"
main_sheet[cell_address].value = "ACBS"

# Step 4: Click on Enter TrialBal Adj button
enter_button = main_sheet['Enter TrialBal Adj button']
enter_button.click()

# Save the changes
workbook.save("updated_file.xlsm") 
