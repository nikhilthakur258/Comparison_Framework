import os
import tabula

def pdf_to_csv_folder(folder_path):
    # List all PDF files in the folder
    pdf_files = [file for file in os.listdir(folder_path) if file.endswith(".pdf")]

    # Convert each PDF file to CSV with the same name
    for pdf_file in pdf_files:
        pdf_path = os.path.join(folder_path, pdf_file)
        csv_file = os.path.splitext(pdf_file)[0] + ".csv"
        output_path = os.path.join(folder_path, csv_file)
        pdf_to_csv(pdf_path, output_path)

def pdf_to_csv(pdf_path, output_path):
    # Read PDF and convert to CSV
    tabula.convert_into(pdf_path, output_path, output_format="csv", pages="all")

# Example usage:
folder_path = "path/to/your/folder"
pdf_to_csv_folder(folder_path)
