import tabula
import pandas as pd

def pdf_to_csv(pdf_path, output_path):
    # Initialize an empty DataFrame to store all tables
    all_tables = pd.DataFrame()

    # Get the number of pages in the PDF
    with open(pdf_path, 'rb') as file:
        num_pages = len(tabula.read_pdf(file, pages='all', silent=True))

    # Extract tables from each page individually
    for page in range(1, num_pages + 1):
        tables = tabula.read_pdf(pdf_path, pages=page, multiple_tables=True, silent=True)
        
        # Check if any tables were extracted
        if tables:
            # Concatenate tables from the current page into one DataFrame
            page_tables = pd.concat(tables)
            
            # Append the tables from the current page to the overall tables DataFrame
            all_tables = all_tables.append(page_tables, ignore_index=True)
    
    # Write all tables to a single CSV file
    all_tables.to_csv(output_path, index=False)

# Example usage:
pdf_path = "input.pdf"
output_path = "output_table.csv"
pdf_to_csv(pdf_path, output_path)
